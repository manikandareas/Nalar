# Application Feature Flows

This document outlines the user and data flow for the main features of the Nalar application.

## 1. Learning Plan Feature

The Learning Plan feature allows users to select a learning plan and track their progress.

### User Flow:
1.  **Onboarding:** New users are directed to the onboarding flow.
2.  **Select Plan:** Users are presented with a list of available learning plans on the `/onboarding/plans` page.
3.  **View Plan:** The user selects a plan, and the `learning-plan.tsx` component displays the details of the plan, including modules and lessons.
4.  **Track Progress:** As the user completes lessons and quizzes, their progress is updated and reflected in the learning plan.

### Data Flow:
1.  **Fetch Plans:** The `app/onboarding/plans/page.tsx` component fetches the available learning plans from the Convex backend using a query from `convex/learning/queries.ts`.
2.  **Select Plan:** When a user selects a plan, a mutation from `convex/learning/mutations.ts` is called to associate the plan with the user.
3.  **Update Progress:** When a user completes a part of the plan, an action from `convex/learning/actions.ts` is triggered to update the user's progress in the database.

## 2. Generate and Fill Quiz Feature

This feature allows users to test their knowledge by taking quizzes related to their learning plan.

### User Flow:
1.  **Start Quiz:** The user can start a quiz from their learning plan or a dedicated quiz section. This is likely initiated by the `quiz-button.tsx` component.
2.  **Take Quiz:** The user is taken to the `/quiz/[quizId]` page, where the `quiz-question.tsx` component displays one question at a time.
3.  **Submit Answers:** The user submits their answers for each question.
4.  **View Results:** After completing the quiz, the user is redirected to the `/quiz/[quizId]/results` page to see their score and review their answers.
5.  **Quiz History:** The user can view their past quiz attempts using the `quiz-history-sheet.tsx` component.

### Data Flow:
1.  **Generate Quiz:** A quiz is generated by an AI agent in `convex/quizzes/agent.ts`. This can be triggered by a user action. The `convex/quizzes/actions.ts` file likely orchestrates this.
2.  **Fetch Quiz:** The `app/(authenticated)/quiz/[quizId]/page.tsx` component fetches the quiz questions from Convex using a query from `convex/quizzes/queries.ts`.
3.  **Save Answers:** As the user answers questions, their answers are saved to the database using mutations from `convex/quizzes/mutations.ts`.
4.  **Calculate Score:** Once the quiz is submitted, an action in `convex/quizzes/actions.ts` calculates the score and stores the results.
5.  **Fetch Results:** The results page fetches the final score and answer details using a query from `convex/quizzes/queries.ts`.

## 3. Knowledge Graph Feature

The Knowledge Graph visually represents the relationships between different concepts in the user's learning domain.

### User Flow:
1.  **View Graph:** The user can access the Knowledge Graph from a dedicated section of the application. The `knowledge-graph.tsx` component renders the graph.
2.  **Interact with Graph:** The user can click on nodes and edges to explore related concepts and access more detailed information.
3.  **Graph Updates:** The graph is updated automatically as the user progresses through their learning plan and new concepts are introduced.

### Data Flow:
1.  **Fetch Graph Data:** The `knowledge-graph.tsx` component fetches the graph data (nodes and edges) from Convex using a query from `convex/knowledge/queries.ts`.
2.  **Update Graph:** As the user learns, the `convex/knowledge/agent.ts` and `convex/knowledge/actions.ts` work together to update the knowledge graph. New concepts and relationships are added to the database via mutations in `convex/knowledge/mutations.ts`.
3.  **Real-time Updates:** The frontend component likely subscribes to the Convex query, so the graph updates in real-time as the underlying data changes.
